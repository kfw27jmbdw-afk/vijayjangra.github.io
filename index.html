<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bubu Master Weaver Pro</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#5f9ea0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <nav class="tab-bar">
            <button class="tab-btn active" onclick="openTab(event, 'construction')">construction</button>
            <button class="tab-btn" onclick="openTab(event, 'weave')">weave</button>
            <button class="tab-btn" onclick="openTab(event, 'fabricView')">fabric view</button>
            <button class="reset-btn" onclick="clearAllData()">‚ö†Ô∏è reset project</button>
        </nav>

        <div id="construction" class="tab-content active">
            <div class="con-layout">
                <div class="con-left">
                    <div class="con-field"><label>EPI</label><span id="epiVal">0</span></div>
                    <div class="con-field"><label>PPI</label><input type="number" id="ppiInput" value="80" oninput="applyAndRender()"></div>
                    <div class="con-field"><label>REED</label><input type="number" id="reedInput" value="40" oninput="applyAndRender()"></div>
                </div>
                <div class="con-right">
                    <div class="pattern-wrap"><h3>warp pattern table</h3><div class="table-scroll"><table id="warpTable"><thead id="warpHeader"></thead><tbody id="warpBody"></tbody></table></div></div>
                    <div class="pattern-wrap"><h3>weft pattern table</h3><div class="table-scroll"><table id="weftTable"><thead id="weftHeader"></thead><tbody id="weftBody"></tbody></table></div></div>
                    <div class="con-preview"><canvas id="fabricCanvas" width="500" height="300"></canvas></div>
                </div>
            </div>
        </div>

        <div id="weave" class="tab-content">
            <div class="weave-layout">
                <div class="weave-sidebar">
                    <div class="sidebar-top">
                        <h3>weave edit (peg plan)</h3>
                        <div id="pegPlanContainer" class="peg-grid"></div>
                    </div>
                    <div class="sidebar-bottom">
                        <h3>denting / drafting</h3>
                        <div class="dent-scroll">
                            <table id="dentTable">
                                <thead><tr><th>D1</th><th>D2</th><th>D3</th><th>D4</th><th>D5</th><th>x</th></tr></thead>
                                <tbody id="dentBody"></tbody>
                            </table>
                        </div>
                        <button onclick="addDentRow()" class="add-row-btn">+ Add Row</button>
                    </div>
                </div>
                <div class="weave-main">
                    <h2>fabric view</h2>
                    <div class="canvas-holder"><canvas id="weaveCanvas" width="600" height="500"></canvas></div>
                </div>
            </div>
        </div>

        <div id="fabricView" class="tab-content">
             <div style="background: rgba(255,255,255,0.2); padding: 10px; margin-bottom: 10px; border-radius: 5px; display: flex; align-items: center; gap: 15px;">
                <label style="font-weight: bold; color: white;">üîç Fabric Zoom:</label>
                <input type="range" id="zoomSlider" min="1" max="20" value="10" step="1" oninput="applyAndRender()" style="flex: 1; cursor: pointer;">
                <span id="zoomVal" style="color: white; font-weight: bold; width: 30px;">10x</span>
            </div>
             <div class="fabric-wrapper">
                <div id="vScale" class="scale-v"></div>
                <div class="canvas-container">
                    <div id="hScale" class="scale-h"></div>
                    <canvas id="largeCanvas" width="800" height="800"></canvas>
                </div>
             </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
